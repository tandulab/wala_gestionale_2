import{g as E,l as s,k as q,h as R,i as Z,c as $,n as G,ah as H,r as m,a as p,b as r,w as h,m as x,o as v,d as o,y as J,e as f,C as z,B as k,_ as K}from"../index35192.js";import{u as O}from"./useComponyStore35192.js";import{h as _,s as B}from"./loader35192.js";import"./common-service35192.js";const P={class:"m-4"},Q={class:"flex align-items-center justify-content-between"},W={class:"flex justify-content-end"},X={class:"formgrid grid col-10 flex-column"},Y={class:"field col-6"},ee={key:0,id:"name",class:"p-error"},ae={class:"col-6 mt-4 flex-column"},te={key:0,class:"flex align-items-top"},oe=["src"],le={key:0,class:"text-center"},ne=E({__name:"CompaniesDetailView",setup(se){const D=s({icon:"pi pi-home",to:"/aziende"}),g=s(""),y=s([{label:""}]),b=q(),n=R(),i=Z(),e=s({}),V=s(),c=O(),u=s(!1),l=$(()=>c.company),N=async function(){try{await c.fetchCompanyDetail(`${b.params.id}`),T()}catch(t){x(i,t)}finally{await _(n)}},S=async function(){if(!w()&&!!e.value.id){await B(n);try{await c.updateCompany(e.value.id,{file:V.value,name:e.value.name}),z(i,{message:"Azienda aggiornata correttamente.",title:""}),k.replace({name:"aziende"})}catch(t){x(i,t)}finally{await _(n)}}},F=async function(){if(!w()){B(n);try{await c.createCompany(e.value),z(i,{message:"Azienda creata correttamente.",title:""}),_(n),await k.replace({name:"aziende"})}catch(t){_(n),x(i,t)}}},T=function(){var t,a,d;e.value.id=(t=l==null?void 0:l.value)==null?void 0:t.id,e.value.name=(a=l==null?void 0:l.value)==null?void 0:a.name,e.value.image_url=(d=l==null?void 0:l.value)==null?void 0:d.image_url},U=function(){g.value!=""&&e.value.id?S():F()},w=function(){var t,a;return((t=e.value)==null?void 0:t.name)==""||((a=e.value)==null?void 0:a.name)==null?u.value=!0:u.value=!1,u.value},A=t=>{e.value.image_url="",V.value=t.files[0]};return G(async()=>{await H(),g.value=b.params.id+"",g.value!=""?(await N(),y.value[0]={label:"Modifica azienda"}):y.value[0]={label:"Nuova azienda"}}),(t,a)=>{const d=m("Breadcrumb"),I=m("Button"),L=m("InputText"),M=m("FileUpload"),j=m("Card");return v(),p("div",P,[r(d,{home:D.value,model:y.value,class:"mb-3 mt-0 pt-0"},null,8,["home","model"]),r(j,null,{content:h(()=>[o("div",Q,[a[2]||(a[2]=o("h1",null,"AZIENDA",-1)),o("div",W,[r(I,{label:"Salva",onClick:U})])]),o("div",X,[o("div",Y,[a[3]||(a[3]=o("label",{for:"name"},"Nome*",-1)),r(L,{id:"name",type:"text",modelValue:e.value.name,"onUpdate:modelValue":a[0]||(a[0]=C=>e.value.name=C),class:J(["w-full",{"p-invalid":u.value}]),onChange:w},null,8,["modelValue","class"]),u.value?(v(),p("small",ee,"Campo obbligatorio.")):f("v-if",!0)]),o("div",ae,[a[5]||(a[5]=o("label",{for:"logo"},"Logo",-1)),r(M,{name:"file",url:"https://www.primefaces.org/upload.php",multiple:!1,accept:"image/*",maxFileSize:2e6,id:"logo",modelValue:e.value.image_url,"onUpdate:modelValue":a[1]||(a[1]=C=>e.value.image_url=C),customUpload:!0,onSelect:A},{content:h(()=>[e.value.image_url?(v(),p("div",te,[o("img",{role:"presentation",class:"p-fileupload-file-thumbnail",src:e.value.image_url},null,8,oe),f(`                  <i
                                      class="pi pi-times p-button-icon text-red-600 cursor-pointer font-semibold icon-delete"
                                      @click="tmp_company.image_url = null"
                                    ></i>`)])):f("v-if",!0)]),empty:h(()=>[e.value.image_url?f("v-if",!0):(v(),p("div",le,[...a[4]||(a[4]=[o("b",null,"Trascina qui l'immagine",-1),o("p",{class:"text-xs"},"(Dimensione massima 2 MB)",-1)])]))]),_:1},8,["modelValue"])])])]),_:1})])}}});const ce=K(ne,[["__file","/Users/giacomo/Developer/tandu/wala/wala-gestionale-aziende/wala-gestionale-aziende/src/views/companies/CompaniesDetailView.vue"]]);export{ce as default};
