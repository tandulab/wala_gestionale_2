import{C as u,D as _,k as s,c as o,E as l}from"../index58703.js";import{C as g}from"./common-service58703.js";class i{static async fetchAll(e){return await u.get("/audiences",{params:e})}static async getAudienceDetail(e){return await u.get(`/audiences/${e}`)}static async createAudience(e){return await u.post("/audiences",e)}static async deleteAudience(e){return await u.delete(`/audiences/${e}`)}static async updateAudience(e,n){return await u.patch(`/audiences/${e}`,n)}static async uploadContactsUrl(e,n){return await u.post(`/audiences/${e}/import_contacts_url`,n)}static async confirmUploadContacts(e,n){return await u.post(`/audiences/${e}/confirm_import_contacts`,n)}}const D=_("audience-store",()=>{const c=s(null),e=s(null),n=o(()=>{var a;return(a=c.value)==null?void 0:a.audiences}),d=o(()=>e.value),p=o(()=>{var a,t;return(t=(a=c.value)==null?void 0:a.total_records)!=null?t:0});async function y(a){try{return c.value=await i.fetchAll(a),c.value}catch(t){throw c.value=null,console.error(t),t}}async function A(a){try{return e.value=(await i.getAudienceDetail(a)).audience,e.value}catch(t){throw e.value=null,console.error(t),t}}async function w(a){try{const t=await i.createAudience(a);return e.value=t.audience,e.value}catch(t){throw console.error(t),t}}async function f(a){try{await i.deleteAudience(a)}catch(t){throw console.error(t),t}}async function m(a,t){try{e.value=await i.updateAudience(a,t)}catch(r){throw console.error(r),r}}async function v(a,t){try{const{upload_url:r,key:C}=await i.uploadContactsUrl(a,{file_name:t.name,file_type:t.type,field_name:"contacts"});return await g.uploadFileToS3(r,t),e.value=(await i.confirmUploadContacts(a,{key:C,name:t.name})).audience,e.value}catch(r){throw console.error(r),r}}function h(){c.value=null,e.value=null}return{paginatedAudiences:l(c),audience:l(e),currentAudiences:n,currentAudience:d,currentAudiencesTotal:p,fetchAllAudiences:y,fetchAudienceDetail:A,createAudience:w,deleteAudience:f,updateAudience:m,importContacts:v,$reset:h}});export{D as u};
