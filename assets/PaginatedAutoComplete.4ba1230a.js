import{l as c,g as q,Q as S,r as C,o as y,f as x,w as B,a as H,d as P,s as V,e as T,_}from"./index.5000a42e.js";function M(r,p,o){const u=c([]),t=c(1),l=c(!0),e=c(!1);async function d(i){t.value=1,e.value=!0;try{const n=await r({page:t.value,limit:o!=null?o:10,query:i||void 0});if(!n)return;l.value=t.value<=n.total_pages,u.value=n[p]}finally{e.value=!1}}async function f(i){if(!!l.value){t.value++,e.value=!0;try{const n=await r({page:t.value,limit:o!=null?o:10,query:i||void 0});if(!n)return;u.value=[...u.value,...n[p]],l.value=t.value<=n.total_pages}finally{e.value=!1}}}return{fetchInit:d,fetchMore:f,data:u,canLoadMore:l,isLoading:e,currentPage:t}}const b={key:0,class:"p-2 text-center"},A=q({__name:"PaginatedAutoComplete",props:{modelValue:{type:null,required:!1},suggestions:{type:Array,required:!1},optionLabel:{type:String,required:!1},placeholder:{type:String,required:!1},dropdown:{type:Boolean,required:!1},scrollHeight:{type:String,required:!1},pageSize:{type:Number,required:!1},panelStyle:{type:Object,required:!1},isLoading:{type:Boolean,required:!1}},emits:["update:modelValue","update:suggestions","firstFetch","fetchMore"],setup(r,{emit:p}){const o=r,u=p,t=c("");let l=null,e=null;const d=a=>{t.value=a.query,u("firstFetch",t.value)},f=()=>{setTimeout(()=>{w()},150)},i=()=>{m()},n=a=>{const s=a.target,g=50;s.scrollHeight-s.scrollTop-s.clientHeight<g&&(e&&clearTimeout(e),e=setTimeout(()=>{u("fetchMore",t.value)},500))},w=()=>{m();const a=document.querySelector(".p-autocomplete-panel");a&&(l=n,a.addEventListener("scroll",l))},m=()=>{if(e&&(clearTimeout(e),e=null),l){const a=document.querySelector(".p-autocomplete-panel");a&&a.removeEventListener("scroll",l),l=null}};return S(()=>{m()}),(a,s)=>{var v,h;const g=C("AutoComplete");return y(),x(g,{"model-value":r.modelValue,"onUpdate:modelValue":s[0]||(s[0]=L=>a.$emit("update:modelValue",L)),suggestions:r.suggestions,onComplete:d,onShow:f,onHide:i,optionLabel:(v=o.optionLabel)!=null?v:"name",placeholder:o.placeholder,loading:r.isLoading,scrollHeight:(h=o.scrollHeight)!=null?h:"300px",class:"overscroll-panel w-full","panel-style":{"max-height":"300px","overflow-y":"auto",overflow:"scroll"},"force-selection":!0,dropdown:""},{footer:B(()=>[o.isLoading?(y(),H("div",b,[...s[1]||(s[1]=[P("i",{class:"pi pi-spin pi-spinner"},null,-1),V(" Caricamento... ",-1)])])):T("v-if",!0)]),_:1},8,["model-value","suggestions","optionLabel","placeholder","loading","scrollHeight"])}}}),k=_(A,[["__file","/Users/giacomo/Developer/tandu/wala/wala-gestionale-aziende/wala-gestionale-aziende/src/components/common/autocomplete/PaginatedAutoComplete.vue"]]);export{k as P,M as u};
