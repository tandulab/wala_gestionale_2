import{C as r,D as g,k as l,c as i,E as p}from"../index58703.js";import{C as _}from"./common-service58703.js";class c{static async fetchAll(a){return await r.get("/companies",{params:a})}static async getCompanyDetail(a){return(await r.get(`/companies/${a}`)).company}static async createCompany(a){return(await r.post("/companies",a)).company}static async deleteCompany(a){await r.delete(`/companies/${a}`)}static async uploadImageUrl(a,t){return await r.post(`/companies/${a}/upload_image_url`,t)}static async confirmUploadImage(a,t){return await r.post(`/companies/${a}/confirm_image_upload`,t)}static async updateCompany(a,t){return await r.patch(`/companies/${a}`,t)}}const D=g("company-store",()=>{const o=l(null),a=l(null),t=i(()=>{var n;return(n=o.value)==null?void 0:n.companies}),m=i(()=>a.value),u=i(()=>{var n,e;return(e=(n=o.value)==null?void 0:n.total_records)!=null?e:0});async function y(n){try{return o.value=await c.fetchAll(n),o.value}catch(e){throw o.value=null,console.error(e),e}}async function f(n){try{a.value=await c.getCompanyDetail(n)}catch(e){throw a.value=null,console.error(e),e}}async function C(n){try{a.value=await c.createCompany(n)}catch(e){throw console.error(e),e}}async function w(n){try{await c.deleteCompany(n)}catch(e){throw console.error(e),e}}async function h(n,e){try{if(e.name&&(a.value=await c.updateCompany(n,{name:e.name})),e.file){const{upload_url:s,key:v}=await c.uploadImageUrl(n,{file_name:e.file.name,file_type:e.file.type,field_name:"image"});await _.uploadFileToS3(s,e.file),await c.confirmUploadImage(n,{key:v,name:e.file.name})}}catch(s){throw console.error(s),s}}function d(){o.value=null,a.value=null}return{paginatedCompanies:p(o),company:p(a),currentCompanies:t,currentCompany:m,currentCompaniesTotal:u,fetchAllCompanies:y,fetchCompanyDetail:f,createCompany:C,deleteCompany:w,updateCompany:h,$reset:d}});export{D as u};
