import{g as T,k as o,j as E,h as D,m as I,r as i,a as h,b as n,w as L,l as g,q as O,o as C,d as c,y as j,e as S,B as U,A as q,_ as z}from"../index58703.js";import{C as A}from"./CampaignsTable58703.js";import{u as M}from"./useReportStore58703.js";import"./useLazyData58703.js";import"./useCampaignStore58703.js";const P={class:"m-4"},F={class:"flex justify-content-between align-item-center"},G={class:"field col-4 px-0"},H={key:0,id:"name",class:"p-error"},J=T({__name:"NewReportView",setup(K){const b=o({icon:"pi pi-home",to:"/reports"}),d=o(""),_=o([{label:"Nuovo report"}]),v=E(),u=D(),s=o(!1),a=o({}),r=o(),f=M(),{showLoader:R,hideLoader:m}=O(),y=async function(){try{return await f.fetchReportDetail(v.params.id)}catch(t){m(),g(u,t)}},w=function(){var t,e;return((t=a.value)==null?void 0:t.name)==""||((e=a.value)==null?void 0:e.name)==null?s.value=!0:s.value=!1,s.value},x=function(){var e;const t=(e=r==null?void 0:r.value)==null?void 0:e.selectedCampaigns;a.value.campaign_ids=[],t.forEach(p=>{var l;(l=a.value.campaign_ids)==null||l.push(p.id+"")}),N()},N=async function(){if(w())return;R();const t={title:a.value.name,campaign_ids:a.value.campaign_ids};try{const e=await f.createReport(t);return U(u,{message:"Il Report verr\xE0 generato entro 10 minuti.",title:""}),q.push("/reports"),m(),e}catch(e){m(),g(u,e)}};return I(async()=>{d.value=v.params.id+"",d.value!=""&&(await y(),_.value[0]={label:"Dettaglio template"})}),(t,e)=>{const p=i("Breadcrumb"),l=i("Button"),V=i("InputText"),B=i("Card");return C(),h("div",P,[n(p,{home:b.value,model:_.value,class:"mb-3 mt-0 pt-0"},null,8,["home","model"]),n(B,null,{content:L(()=>[c("div",F,[e[1]||(e[1]=c("h1",null,"NUOVO REPORT",-1)),n(l,{label:"Crea Report",onClick:x})]),c("div",G,[e[2]||(e[2]=c("label",{for:"name"},"Nome report*",-1)),n(V,{id:"name",type:"text",modelValue:a.value.name,"onUpdate:modelValue":e[0]||(e[0]=k=>a.value.name=k),class:j(["w-full",{"p-invalid":s.value}]),onChange:w},null,8,["modelValue","class"]),s.value?(C(),h("small",H,"Campo obbligatorio.")):S("v-if",!0)]),n(A,{ref_key:"childComponent",ref:r},null,512)]),_:1})])}}});const $=z(J,[["__file","/opt/atlassian/pipelines/agent/build/src/views/reports/NewReportView.vue"]]);export{$ as default};
