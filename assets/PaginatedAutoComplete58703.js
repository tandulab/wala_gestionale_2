import{k as c,g as S,L as w,r as C,o as y,f as x,w as B,a as H,d as P,s as V,e as b,_ as T}from"../index58703.js";function k(r,p,t){const u=c([]),o=c(1),a=c(!0),e=c(!1);async function d(i){o.value=1,e.value=!0;try{const n=await r({page:o.value,limit:t!=null?t:10,query:i||void 0});if(!n)return;a.value=o.value<=n.total_pages,u.value=n[p]}finally{e.value=!1}}async function f(i){if(!!a.value){o.value++,e.value=!0;try{const n=await r({page:o.value,limit:t!=null?t:10,query:i||void 0});if(!n)return;u.value=[...u.value,...n[p]],a.value=o.value<=n.total_pages}finally{e.value=!1}}}return{fetchInit:d,fetchMore:f,data:u,canLoadMore:a,isLoading:e,currentPage:o}}const _={key:0,class:"p-2 text-center"},A=S({__name:"PaginatedAutoComplete",props:{modelValue:{type:null,required:!1},suggestions:{type:Array,required:!1},optionLabel:{type:String,required:!1},placeholder:{type:String,required:!1},dropdown:{type:Boolean,required:!1},scrollHeight:{type:String,required:!1},pageSize:{type:Number,required:!1},panelStyle:{type:Object,required:!1},isLoading:{type:Boolean,required:!1}},emits:["update:modelValue","update:suggestions","firstFetch","fetchMore"],setup(r,{emit:p}){const t=r,u=p,o=c("");let a=null,e=null;const d=l=>{o.value=l.query,u("firstFetch",o.value)},f=()=>{setTimeout(()=>{L()},150)},i=()=>{m()},n=l=>{const s=l.target,g=50;s.scrollHeight-s.scrollTop-s.clientHeight<g&&(e&&clearTimeout(e),e=setTimeout(()=>{u("fetchMore",o.value)},500))},L=()=>{m();const l=document.querySelector(".p-autocomplete-panel");l&&(a=n,l.addEventListener("scroll",a))},m=()=>{if(e&&(clearTimeout(e),e=null),a){const l=document.querySelector(".p-autocomplete-panel");l&&l.removeEventListener("scroll",a),a=null}};return w(()=>{m()}),(l,s)=>{var v,h;const g=C("AutoComplete");return y(),x(g,{"model-value":r.modelValue,"onUpdate:modelValue":s[0]||(s[0]=q=>l.$emit("update:modelValue",q)),suggestions:r.suggestions,onComplete:d,onShow:f,onHide:i,optionLabel:(v=t.optionLabel)!=null?v:"name",placeholder:t.placeholder,loading:r.isLoading,scrollHeight:(h=t.scrollHeight)!=null?h:"300px",class:"overscroll-panel w-full","panel-style":{"max-height":"300px","overflow-y":"auto",overflow:"scroll"},"force-selection":!0,dropdown:""},{footer:B(()=>[t.isLoading?(y(),H("div",_,[...s[1]||(s[1]=[P("i",{class:"pi pi-spin pi-spinner"},null,-1),V(" Caricamento... ",-1)])])):b("v-if",!0)]),_:1},8,["model-value","suggestions","optionLabel","placeholder","loading","scrollHeight"])}}}),M=T(A,[["__file","/opt/atlassian/pipelines/agent/build/src/components/common/autocomplete/PaginatedAutoComplete.vue"]]);export{M as P,k as u};
