import{g as V,h as j,i as G,k as x,c as w,l as k,m as J,r as l,n as H,o as d,a as m,b as o,w as n,s as D,v as Q,t as y,p as i,x as W,G as X,F as Z,z as S,q as ee,A as te,B as oe,_ as F,d as b}from"../index58703.js";import{T as re,u as ae}from"./useLazyData58703.js";import{u as B}from"./useReportStore58703.js";const se=V({__name:"ReportsTable",setup(M){const p=j(),f=G(),_=x(),a=B(),{hideLoader:v}=ee(),u=x({title:{value:"",matchMode:re.LIKE}}),{onSort:g,onPage:L,loadLazyData:h,isLoading:N,onFilter:K,tableRows:z}=ae({rows:30},P,localStorage.getItem("new-dt-reports")?JSON.parse(localStorage.getItem("new-dt-reports")):void 0),I=w(()=>a.currentReports),$=w(()=>a.currentReportsTotal);async function P(r){try{await a.fetchAllReports(r)}catch(e){k(p,e)}finally{await v()}}const Y=async function(r){try{await a.deleteReport(r),oe(p,{message:"Report eliminato correttamente.",title:""}),await h()}catch(e){k(p,e)}},q=(r,e)=>{f.require({target:r.currentTarget,message:"Sei sicuro di voler eliminare questo report?",icon:"pi pi-info-circle",acceptClass:"p-button-danger",accept:()=>{Y(e)}})},A=function(r){te.push({name:"dettaglio-report",params:{id:r.id}})};return J(()=>{h()}),(r,e)=>{const E=l("InputText"),c=l("Column"),R=l("Button"),U=l("DataTable"),O=l("ConfirmPopup"),T=H("tooltip");return d(),m("div",null,[o(U,{value:I.value,totalRecords:$.value,lazy:!0,paginator:!0,rows:i(z),filters:u.value,"onUpdate:filters":e[0]||(e[0]=t=>u.value=t),ref_key:"dt",ref:_,dataKey:"id",loading:i(N),onPage:e[1]||(e[1]=t=>i(L)(t)),onSort:e[2]||(e[2]=t=>i(g)(t)),onFilter:e[3]||(e[3]=()=>i(K)(u.value)),filterDisplay:"row",stateStorage:"local",stateKey:"new-dt-reports",removableSort:""},{empty:n(()=>[...e[4]||(e[4]=[D(" Nessun report trovato. ",-1)])]),default:n(()=>[o(c,{field:"title",header:"Nome",sortable:!0,showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:n(({filterModel:t,filterCallback:s})=>[o(E,{type:"text",modelValue:t.value,"onUpdate:modelValue":C=>t.value=C,onKeydown:Q(C=>s(),["enter"]),class:"p-column-filter",placeholder:"Filtra per report"},null,8,["modelValue","onUpdate:modelValue","onKeydown"])]),_:1}),o(c,{field:"created_at",header:"Data creazione",sortable:!1},{body:n(({data:t})=>[D(y(i(W).unix(t.created_at).format("DD/MM/YYYY")),1)]),_:1}),o(c,{field:"campaign",header:"Campagne",sortable:!1},{body:n(({data:t})=>[(d(!0),m(X,null,Z(t.old_campaign_names,s=>(d(),m("p",{key:s,class:"m-0"},y(s),1))),128))]),_:1}),o(c,{header:"",style:{width:"10rem"}},{body:n(({data:t})=>[S(o(R,{type:"button",onClick:s=>A(t),"aria-haspopup":"true","aria-controls":"overlay_menu",class:"p-button-text p-button-rounded text-300 surface-200 mr-3",icon:"pi pi-chart-bar"},null,8,["onClick"]),[[T,"Report",void 0,{top:!0}]]),S(o(R,{type:"button",onClick:s=>q(s,t.id),"aria-haspopup":"true","aria-controls":"overlay_menu",class:"p-button-text p-button-rounded text-300 surface-200",icon:"pi pi-trash"},null,8,["onClick"]),[[T,"Elimina",void 0,{top:!0}]])]),_:1})]),_:1},8,["value","totalRecords","rows","filters","loading"]),o(O)])}}}),ne=F(se,[["__file","/opt/atlassian/pipelines/agent/build/src/components/tables/ReportsTable.vue"]]),le={class:"flex justify-content-between align-items-center"},ie={class:"uppercase"},pe=V({__name:"ReportsView",setup(M){const p=B(),f=w(()=>p.currentReportsTotal);return(_,a)=>{const v=l("Button"),u=l("Card");return d(),m("div",null,[o(u,null,{content:n(()=>[b("div",le,[b("h1",ie,[b("span",null,y(f.value)+" Report",1)]),o(v,{class:"",label:"Nuovo report",onClick:a[0]||(a[0]=g=>_.$router.push("/nuovo-report"))})]),o(ne)]),_:1})])}}}),me=F(pe,[["__file","/opt/atlassian/pipelines/agent/build/src/views/reports/ReportsView.vue"]]);export{me as default};
