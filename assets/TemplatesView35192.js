import{n as N,a0 as x,h as S,i as A,j as F,l as i,c as C,a1 as w,m as h,x as z,B as V,C as k,a2 as y,_ as M,r as p,a as T,b as m,w as d,o as g,s as E,t as D,d as b,e as q}from"../index35192.js";import{h as B}from"./loader35192.js";const O={setup(){N(()=>{r.value=!0,e.value={first:0,rows:o.value.rows,sortField:null,sortOrder:null,filters:l.value};const t=localStorage.getItem("dt-templates");if(e.value.page==null&&t){let a=JSON.parse(t);e.value.first=a.first,e.value.page=a.first/e.value.rows}x.register("filter_template",(a,R)=>a===R),c()});const s=S(),n=A(),_=F(),o=i(),l=i({name:{value:"",matchMode:"contains"}}),r=i(!0),e=i(),u=i(0),f=i([{label:"My Filter",value:"filter_template"}]),v=C(()=>s.getters[y.CURRENT_TEMPLATES]);function c(){r.value=!0;const t=new Map;t.set("name",l.value.name?l.value.name.value:""),t.set("page",e.value.page+1),t.set("per_page",e.value.rows),e.value.sortField&&(e.value.sortOrder==1?t.set("sorted_by",e.value.sortField+"_asc"):t.set("sorted_by",e.value.sortField+"_desc")),setTimeout(()=>{L(t)},Math.random()*1e3+250)}const L=async function(t){try{const a=await s.dispatch(w.FETCH_ALL_TEMPLATES,t);return r.value=!1,a}catch(a){B(s),h(n,a)}},P=async function(t){await s.dispatch(w.DELETE_TEMPLATE,t).then(()=>{k(n,{message:"Template eliminato correttamente.",title:""}),c()}).catch(a=>{h(n,a)})};return{dt:o,response:v,filters:l,loading:r,totalRecords:u,lazyParams:e,loadLazyData:c,matchModes:f,onPage:t=>{e.value=t,c()},onSort:t=>{e.value=t,c()},onFilter:()=>{e.value.page=0,e.value.filters=l.value,c()},confirmDeleteTemplate:(t,a)=>{_.require({target:t.currentTarget,message:"Sei sicuro di voler eliminare questo template?",icon:"pi pi-info-circle",acceptClass:"p-button-danger",accept:()=>{P(a)}})},onRowSelect:function(t){V.push({name:"dettaglio-template",params:{id:t.data.id}})},moment:z}}};function U(s,n,_,o,l,r){const e=p("Column"),u=p("DataTable"),f=p("ConfirmPopup");return g(),T("div",null,[m(u,{value:o.response.questionnaires,lazy:!0,ref:"dt",dataKey:"id",loading:o.loading,removableSort:"",selectionMode:"single",onRowSelect:o.onRowSelect},{empty:d(()=>[...n[0]||(n[0]=[E(" Nessun template trovato. ",-1)])]),default:d(()=>[m(e,{field:"name",header:"Nome"}),m(e,{field:"created_at",header:"Data creazione",sortable:!1},{body:d(({data:v})=>[E(D(o.moment.unix(v.created_at).format("DD/MM/YYYY")),1)]),_:1})]),_:1},8,["value","loading","onRowSelect"]),m(f)])}const Y=M(O,[["render",U],["__file","/Users/giacomo/Developer/tandu/wala/wala-gestionale-aziende/wala-gestionale-aziende/src/components/tables/TemplatesTable.vue"]]),$={setup(){const s=S();return{templates:C(()=>s.getters[y.CURRENT_TEMPLATES])}},components:{TemplatesTable:Y}},j={class:"flex justify-content-between align-items-center"},I={key:0,class:"uppercase"};function G(s,n,_,o,l,r){const e=p("TemplatesTable"),u=p("Card");return g(),T("div",null,[m(u,null,{content:d(()=>[b("div",j,[o.templates?(g(),T("h1",I,[b("span",null,D(o.templates.total)+" Template questionario",1)])):q("v-if",!0)]),m(e)]),_:1})])}const ee=M($,[["render",G],["__file","/Users/giacomo/Developer/tandu/wala/wala-gestionale-aziende/wala-gestionale-aziende/src/views/templates/TemplatesView.vue"]]);export{ee as default};
