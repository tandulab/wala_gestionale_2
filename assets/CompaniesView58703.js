import{g as S,h as O,i as j,k,c as _,l as x,m as J,r as n,n as G,o as l,a as c,b as o,w as r,s as H,v as Q,e as V,z,p as u,q as W,A as X,B as Y,_ as D,d as Z,t as ee}from"../index58703.js";import{u as M}from"./useComponyStore58703.js";import{T as te,u as oe}from"./useLazyData58703.js";import"./common-service58703.js";const ae=["src"],ne=S({__name:"CompaniesTable",setup(B){const s=O(),v=j(),m=k(),i=M(),{hideLoader:d}=W(),p=k({name:{value:"",matchMode:te.LIKE}}),{onSort:y,onPage:g,loadLazyData:w,isLoading:N,onFilter:F,tableRows:L}=oe({rows:30},$,localStorage.getItem("new-dt-companies")?JSON.parse(localStorage.getItem("new-dt-companies")):void 0),A=_(()=>i.currentCompanies),K=_(()=>i.currentCompaniesTotal);async function $(a){try{await i.fetchAllCompanies(a)}catch(e){x(s,e)}finally{d()}}const I=async function(a){try{await i.deleteCompany(a),Y(s,{message:"Azienda eliminata correttamente.",title:""}),await w()}catch(e){x(s,e)}},E=(a,e)=>{v.require({target:a.currentTarget,message:"Sei sicuro di voler eliminare questa azienda?",icon:"pi pi-info-circle",acceptClass:"p-button-danger",accept:()=>{I(e)}})},P=function(a){X.push({name:"dettaglio-azienda",params:{id:a.id}})};return J(()=>{w()}),(a,e)=>{const q=n("InputText"),C=n("Column"),b=n("Button"),R=n("DataTable"),U=n("ConfirmPopup"),h=G("tooltip");return l(),c("div",null,[o(R,{value:A.value,lazy:!0,paginator:!0,rows:u(L),totalRecords:K.value,filters:p.value,"onUpdate:filters":e[0]||(e[0]=t=>p.value=t),ref_key:"dt",ref:m,dataKey:"id",loading:u(N),onPage:e[1]||(e[1]=t=>u(g)(t)),onSort:e[2]||(e[2]=t=>u(y)(t)),onFilter:e[3]||(e[3]=()=>u(F)(p.value)),filterDisplay:"row",stateStorage:"local",stateKey:"new-dt-companies",removableSort:""},{empty:r(()=>[...e[4]||(e[4]=[H(" Nessuna azienda trovata.",-1)])]),default:r(()=>[o(C,{field:"name",header:"Nome",filterMatchMode:"contains",ref:"name",sortable:!0,showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:r(({filterModel:t,filterCallback:f})=>[o(q,{type:"text",modelValue:t.value,"onUpdate:modelValue":T=>t.value=T,onKeydown:Q(T=>f(),["enter"]),class:"p-column-filter",placeholder:"Filtra per nome"},null,8,["modelValue","onUpdate:modelValue","onKeydown"])]),_:1},512),o(C,{field:"logo",header:"Logo",sortable:!1},{body:r(({data:t})=>[t.image_url?(l(),c("img",{key:0,src:t.image_url,style:{height:"4rem"}},null,8,ae)):V("v-if",!0)]),_:1}),o(C,{header:"",style:{width:"9rem"}},{body:r(({data:t})=>[z(o(b,{type:"button",onClick:f=>P(t),class:"p-button-text p-button-rounded text-300 surface-200 mr-3",icon:"pi pi-pencil"},null,8,["onClick"]),[[h,"Modifica",void 0,{top:!0}]]),z(o(b,{type:"button",onClick:f=>E(f,t.id),"aria-haspopup":"true","aria-controls":"overlay_menu",class:"p-button-text p-button-rounded text-300 surface-200",icon:"pi pi-trash"},null,8,["onClick"]),[[h,"Elimina",void 0,{top:!0}]])]),_:1})]),_:1},8,["value","rows","totalRecords","filters","loading"]),o(U)])}}}),se=D(ne,[["__file","/opt/atlassian/pipelines/agent/build/src/components/tables/CompaniesTable.vue"]]),ie={class:"flex justify-content-between align-items-center"},re={key:0,class:"uppercase"},le={key:0},ce={key:1},pe=S({__name:"CompaniesView",setup(B){const s=M(),v=_(()=>s.currentCompanies),m=_(()=>s.currentCompaniesTotal);return(i,d)=>{const p=n("Button"),y=n("Card");return l(),c("div",null,[o(y,null,{content:r(()=>[Z("div",ie,[v.value?(l(),c("h1",re,[m.value==1?(l(),c("span",le," 1 Azienda")):(l(),c("span",ce,ee(m.value)+" Aziende",1))])):V("v-if",!0),o(p,{label:"Nuova azienda",onClick:d[0]||(d[0]=g=>i.$router.push("/dettaglio-azienda"))})]),o(se)]),_:1})])}}}),_e=D(pe,[["__file","/opt/atlassian/pipelines/agent/build/src/views/companies/CompaniesView.vue"]]);export{_e as default};
