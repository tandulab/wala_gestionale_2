import{g as S,h as j,i as O,j as J,l as z,c as _,m as k,n as G,r as s,p as H,o as r,a as l,b as o,w as i,s as Q,v as W,e as D,z as x,q as u,B as X,C as Y,_ as V,d as Z,t as ee}from"./index.5000a42e.js";import{u as M}from"./useComponyStore.34f3ed94.js";import{T as te,u as oe}from"./useLazyData.0e178cfb.js";import{h as ae}from"./loader.dae3a98d.js";import"./common-service.13629423.js";const ne=["src"],se=S({__name:"CompaniesTable",setup(B){const m=j(),c=O(),d=J(),v=z(),n=M(),p=z({name:{value:"",matchMode:te.LIKE}}),{onSort:y,onPage:C,loadLazyData:w,isLoading:N,onFilter:F,tableRows:K}=oe({rows:30},A,localStorage.getItem("new-dt-companies")?JSON.parse(localStorage.getItem("new-dt-companies")):void 0),L=_(()=>n.currentCompanies),$=_(()=>n.currentCompaniesTotal);async function A(a){try{await n.fetchAllCompanies(a)}catch(e){k(c,e)}finally{await ae(m)}}const I=async function(a){try{await n.deleteCompany(a),Y(c,{message:"Azienda eliminata correttamente.",title:""}),await w()}catch(e){k(c,e)}},U=(a,e)=>{d.require({target:a.currentTarget,message:"Sei sicuro di voler eliminare questa azienda?",icon:"pi pi-info-circle",acceptClass:"p-button-danger",accept:()=>{I(e)}})},E=function(a){X.push({name:"dettaglio-azienda",params:{id:a.id}})};return G(()=>{w()}),(a,e)=>{const P=s("InputText"),g=s("Column"),h=s("Button"),q=s("DataTable"),R=s("ConfirmPopup"),b=H("tooltip");return r(),l("div",null,[o(q,{value:L.value,lazy:!0,paginator:!0,rows:u(K),totalRecords:$.value,filters:p.value,"onUpdate:filters":e[0]||(e[0]=t=>p.value=t),ref_key:"dt",ref:v,dataKey:"id",loading:u(N),onPage:e[1]||(e[1]=t=>u(C)(t)),onSort:e[2]||(e[2]=t=>u(y)(t)),onFilter:e[3]||(e[3]=()=>u(F)(p.value)),filterDisplay:"row",stateStorage:"local",stateKey:"new-dt-companies",removableSort:""},{empty:i(()=>[...e[4]||(e[4]=[Q(" Nessuna azienda trovata.",-1)])]),default:i(()=>[o(g,{field:"name",header:"Nome",filterMatchMode:"contains",ref:"name",sortable:!0,showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:i(({filterModel:t,filterCallback:f})=>[o(P,{type:"text",modelValue:t.value,"onUpdate:modelValue":T=>t.value=T,onKeydown:W(T=>f(),["enter"]),class:"p-column-filter",placeholder:"Filtra per nome"},null,8,["modelValue","onUpdate:modelValue","onKeydown"])]),_:1},512),o(g,{field:"logo",header:"Logo",sortable:!1},{body:i(({data:t})=>[t.image_url?(r(),l("img",{key:0,src:t.image_url,style:{height:"4rem"}},null,8,ne)):D("v-if",!0)]),_:1}),o(g,{header:"",style:{width:"9rem"}},{body:i(({data:t})=>[x(o(h,{type:"button",onClick:f=>E(t),class:"p-button-text p-button-rounded text-300 surface-200 mr-3",icon:"pi pi-pencil"},null,8,["onClick"]),[[b,"Modifica",void 0,{top:!0}]]),x(o(h,{type:"button",onClick:f=>U(f,t.id),"aria-haspopup":"true","aria-controls":"overlay_menu",class:"p-button-text p-button-rounded text-300 surface-200",icon:"pi pi-trash"},null,8,["onClick"]),[[b,"Elimina",void 0,{top:!0}]])]),_:1})]),_:1},8,["value","rows","totalRecords","filters","loading"]),o(R)])}}}),ie=V(se,[["__file","/Users/giacomo/Developer/tandu/wala/wala-gestionale-aziende/wala-gestionale-aziende/src/components/tables/CompaniesTable.vue"]]),re={class:"flex justify-content-between align-items-center"},le={key:0,class:"uppercase"},ce={key:0},pe={key:1},ue=S({__name:"CompaniesView",setup(B){const m=M(),c=_(()=>m.currentCompanies),d=_(()=>m.currentCompaniesTotal);return(v,n)=>{const p=s("Button"),y=s("Card");return r(),l("div",null,[o(y,null,{content:i(()=>[Z("div",re,[c.value?(r(),l("h1",le,[d.value==1?(r(),l("span",ce," 1 Azienda")):(r(),l("span",pe,ee(d.value)+" Aziende",1))])):D("v-if",!0),o(p,{label:"Nuova azienda",onClick:n[0]||(n[0]=C=>v.$router.push("/dettaglio-azienda"))})]),o(ie)]),_:1})])}}}),ye=V(ue,[["__file","/Users/giacomo/Developer/tandu/wala/wala-gestionale-aziende/wala-gestionale-aziende/src/views/companies/CompaniesView.vue"]]);export{ye as default};
