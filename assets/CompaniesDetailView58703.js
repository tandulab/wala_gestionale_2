import{g as M,k as n,j as q,h as E,c as R,m as Z,a1 as $,r as u,a as p,b as m,w,l as b,q as G,o as v,d as o,y as H,e as f,B as k,A as z,_ as J}from"../index58703.js";import{u as K}from"./useComponyStore58703.js";import"./common-service58703.js";const O={class:"m-4"},P={class:"flex align-items-center justify-content-between"},Q={class:"flex justify-content-end"},W={class:"formgrid grid col-10 flex-column"},X={class:"field col-6"},Y={key:0,id:"name",class:"p-error"},ee={class:"col-6 mt-4 flex-column"},ae={key:0,class:"flex align-items-top"},te=["src"],oe={key:0,class:"text-center"},le=M({__name:"CompaniesDetailView",setup(ne){const B=n({icon:"pi pi-home",to:"/aziende"}),_=n(""),g=n([{label:""}]),x=q(),s=E(),e=n({}),h=n(),c=K(),{showLoader:V,hideLoader:r}=G(),i=n(!1),l=R(()=>c.company),D=async function(){try{await c.fetchCompanyDetail(`${x.params.id}`),S()}catch(t){b(s,t)}finally{r()}},N=async function(){if(!y()&&!!e.value.id){V();try{await c.updateCompany(e.value.id,{file:h.value,name:e.value.name}),k(s,{message:"Azienda aggiornata correttamente.",title:""}),z.replace({name:"aziende"})}catch(t){b(s,t)}finally{r()}}},F=async function(){if(!y()){V();try{await c.createCompany(e.value),k(s,{message:"Azienda creata correttamente.",title:""}),r(),await z.replace({name:"aziende"})}catch(t){r(),b(s,t)}}},S=function(){var t,a,d;e.value.id=(t=l==null?void 0:l.value)==null?void 0:t.id,e.value.name=(a=l==null?void 0:l.value)==null?void 0:a.name,e.value.image_url=(d=l==null?void 0:l.value)==null?void 0:d.image_url},T=function(){_.value!=""&&e.value.id?N():F()},y=function(){var t,a;return((t=e.value)==null?void 0:t.name)==""||((a=e.value)==null?void 0:a.name)==null?i.value=!0:i.value=!1,i.value},A=t=>{e.value.image_url="",h.value=t.files[0]};return Z(async()=>{await $(),_.value=x.params.id+"",_.value!=""?(await D(),g.value[0]={label:"Modifica azienda"}):g.value[0]={label:"Nuova azienda"}}),(t,a)=>{const d=u("Breadcrumb"),U=u("Button"),L=u("InputText"),j=u("FileUpload"),I=u("Card");return v(),p("div",O,[m(d,{home:B.value,model:g.value,class:"mb-3 mt-0 pt-0"},null,8,["home","model"]),m(I,null,{content:w(()=>[o("div",P,[a[2]||(a[2]=o("h1",null,"AZIENDA",-1)),o("div",Q,[m(U,{label:"Salva",onClick:T})])]),o("div",W,[o("div",X,[a[3]||(a[3]=o("label",{for:"name"},"Nome*",-1)),m(L,{id:"name",type:"text",modelValue:e.value.name,"onUpdate:modelValue":a[0]||(a[0]=C=>e.value.name=C),class:H(["w-full",{"p-invalid":i.value}]),onChange:y},null,8,["modelValue","class"]),i.value?(v(),p("small",Y,"Campo obbligatorio.")):f("v-if",!0)]),o("div",ee,[a[5]||(a[5]=o("label",{for:"logo"},"Logo",-1)),m(j,{name:"file",url:"https://www.primefaces.org/upload.php",multiple:!1,accept:"image/*",maxFileSize:2e6,id:"logo",modelValue:e.value.image_url,"onUpdate:modelValue":a[1]||(a[1]=C=>e.value.image_url=C),customUpload:!0,onSelect:A},{content:w(()=>[e.value.image_url?(v(),p("div",ae,[o("img",{role:"presentation",class:"p-fileupload-file-thumbnail",src:e.value.image_url},null,8,te),f(`                  <i
                                      class="pi pi-times p-button-icon text-red-600 cursor-pointer font-semibold icon-delete"
                                      @click="tmp_company.image_url = null"
                                    ></i>`)])):f("v-if",!0)]),empty:w(()=>[e.value.image_url?f("v-if",!0):(v(),p("div",oe,[...a[4]||(a[4]=[o("b",null,"Trascina qui l'immagine",-1),o("p",{class:"text-xs"},"(Dimensione massima 2 MB)",-1)])]))]),_:1},8,["modelValue"])])])]),_:1})])}}});const me=J(le,[["__file","/opt/atlassian/pipelines/agent/build/src/views/companies/CompaniesDetailView.vue"]]);export{me as default};
