import{g as E,l as o,k,h as O,i as I,n as D,r as c,a as g,b as r,w as S,a5 as z,m as h,o as C,d as m,y as L,e as P,C as U,B as A,_ as j}from"../index35192.js";import{C as F}from"./CampaignsTable35192.js";import{u as H}from"./useReportStore35192.js";import{h as d,s as M}from"./loader35192.js";import"./useLazyData35192.js";import"./useCampaignStore35192.js";const q={class:"m-4"},G={class:"flex justify-content-between align-item-center"},J={class:"field col-4 px-0"},K={key:0,id:"name",class:"p-error"},Q=E({__name:"NewReportView",setup(W){const R=o({icon:"pi pi-home",to:"/reports"}),_=o(""),v=o([{label:"Nuovo report"}]),f=k(),s=O(),u=I(),n=o(!1),a=o({}),l=o(),b=H(),y=async function(){try{return await s.dispatch(z.FETCH_REPORT_DETAIL,f.params.id+"")}catch(t){d(s),h(u,t)}},w=function(){var t,e;return((t=a.value)==null?void 0:t.name)==""||((e=a.value)==null?void 0:e.name)==null?n.value=!0:n.value=!1,n.value},N=function(){var e;const t=(e=l==null?void 0:l.value)==null?void 0:e.selectedCampaigns;a.value.campaign_ids=[],t.forEach(p=>{var i;(i=a.value.campaign_ids)==null||i.push(p.id+"")}),T()},T=async function(){if(w())return;M(s);const t={title:a.value.name,campaign_ids:a.value.campaign_ids};try{const e=await b.createReport(t);return U(u,{message:"Il Report verr\xE0 generato entro 10 minuti.",title:""}),A.push("/reports"),d(s),e}catch(e){d(s),h(u,e)}};return D(async()=>{_.value=f.params.id+"",_.value!=""&&(await y(),v.value[0]={label:"Dettaglio template"})}),(t,e)=>{const p=c("Breadcrumb"),i=c("Button"),x=c("InputText"),V=c("Card");return C(),g("div",q,[r(p,{home:R.value,model:v.value,class:"mb-3 mt-0 pt-0"},null,8,["home","model"]),r(V,null,{content:S(()=>[m("div",G,[e[1]||(e[1]=m("h1",null,"NUOVO REPORT",-1)),r(i,{label:"Crea Report",onClick:N})]),m("div",J,[e[2]||(e[2]=m("label",{for:"name"},"Nome report*",-1)),r(x,{id:"name",type:"text",modelValue:a.value.name,"onUpdate:modelValue":e[0]||(e[0]=B=>a.value.name=B),class:L(["w-full",{"p-invalid":n.value}]),onChange:w},null,8,["modelValue","class"]),n.value?(C(),g("small",K,"Campo obbligatorio.")):P("v-if",!0)]),r(F,{ref_key:"childComponent",ref:l},null,512)]),_:1})])}}});const ae=j(Q,[["__file","/Users/giacomo/Developer/tandu/wala/wala-gestionale-aziende/wala-gestionale-aziende/src/views/reports/NewReportView.vue"]]);export{ae as default};
