import{Q as n,C as l,D as S,k as f,c as R,E as h}from"../index58703.js";const _="headers",m="https://wala-api-staging.tandu.it/";function E(){const t=localStorage.getItem(_);return t?JSON.parse(t):null}function w(){n.defaults.baseURL=m,console.log(`[ApiService] | baseURL: ${n.defaults.baseURL}`),k()}function k(){const t=E();return t?(n.defaults.headers.common["access-token"]=t["access-token"],n.defaults.headers.common.client=t.client,n.defaults.headers.common.uid=t.uid,n.defaults.headers.common["token-type"]=t["token-type"],{"access-token":t["access-token"],client:t.client,uid:t.uid,"token-type":t["token-type"]}):{}}function p(t,e){const r=[];e!=null&&e.forEach((i,d)=>{i&&r.push([d,i].join("="))});const a=e!==void 0?`${t}?${r.join("&")}`:t;return console.log(`[ApiService] | GET ${a}`),w(),n.get(a)}function D(t,e){return console.log(`[ApiService] | POST ${t}`),w(),n.post(t,e)}function V(t,e){return console.log(`[ApiService] | DELETE ${t}`),w(),n.delete(t,{data:e})}n.interceptors.response.use(t=>t,t=>Promise.reject(t.response));class u{static async fetchAll(e){return(await p("/reports",e)).data}static async getReportDetail(e){const r=e.get("report_id");return e.delete("report_id"),(await p(`/reports/${r}/report`,e)).data}static async createReport(e){return(await D("/reports",e)).data.report}static async deleteReport(e){return(await V(`/reports/${e}`)).data}static async show(e){const r=e.get("report_id");return e.delete("report_id"),(await p(`/campaigns/${r}/report`,e)).data}static async download(e){return(await p(`/campaigns/${e}/download_report`)).data}static async refreshReport(e){return(await p(`/reports/${e}/refresh_report`)).data}static async fetchAllV2(e){return await l.get("/reports",{params:e})}static async getReportDetailV2(e,r){return await l.get(`/reports/${e}`,{params:r})}static async createReportV2(e){return await l.post("/reports",e)}static async deleteReportV2(e){await l.delete(`/reports/${e}`)}}const U=S("report-store",()=>{const t=f(null),e=f(null),r=f(!1),a=R(()=>{var o;return(o=t.value)==null?void 0:o.reports}),i=R(()=>{var o,s;return(s=(o=t.value)==null?void 0:o.total_records)!=null?s:0}),d=R(()=>e.value);async function y(o){try{t.value=await u.fetchAllV2(o)}catch(s){throw t.value=null,console.error(s),s}}async function g(o,s){try{const c=await u.getReportDetailV2(o,s);return r.value=c.version===2,e.value=c.old_report?c.old_report:c.report,e.value}catch(c){throw e.value=null,console.error(c),c}}async function v(o){try{return e.value=(await u.createReportV2(o)).report,e.value}catch(s){throw e.value=null,console.error(s),s}}async function $(o){try{await u.deleteReportV2(o)}catch(s){throw console.error(s),s}}function A(){t.value=null,e.value=null}return{paginatedReports:h(t),oldReport:h(e),isNewReport:h(r),currentReports:a,currentReportsTotal:i,currentReport:d,fetchAllReports:y,fetchReportDetail:g,createReport:v,deleteReport:$,$reset:A}});export{U as u};
